enum Status {
  Started
  Ready
  Finished
}

enum ItemType {
  ERC20
  ERC1155
}

enum ItemEffect {
  Burn
  MoveToTreasury
  Custom
}

enum BuildingType {
  theforge
  ivorytower
  summoningcircle
  harvesters
  other
}

enum TreasureCategory {
  Alchemy
  Arcana
  Brewing
  Enchanting
  Leatherworking
  Smithing
}

type Building @entity {
  id: Bytes!

  type: BuildingType!
  address: Bytes!
  ratePerSecond: BigInt!
  generatedCorruptionCap: BigInt!
  recipes: [Recipe!]!
}

type Recipe @entity(immutable: true) {
  id: Bytes!

  corruptionRemoved: BigInt!
  items: [RecipeItem!]! @derivedFrom(field: "recipe")
}

type RecipeItem @entity(immutable: true) {
  id: Bytes!

  recipe: Recipe!

  address: Bytes
  type: ItemType!
  effect: ItemEffect!
  effectChance: BigInt!
  itemId: BigInt
  amount: BigInt
  customHandler: Bytes
  customRequirementData: [BigInt!]
  treasureRequirement: RecipeItemTreasureRequirement @derivedFrom(field: "item")
}

type RecipeItemTreasureRequirement @entity(immutable: true) {
  id: Bytes!

  item: RecipeItem!

  tier: Int!
  category1: TreasureCategory!
  category2: TreasureCategory!
  amount: Int!
}

type Removal @entity {
  id: Bytes!

  user: User!
  building: Building!
  recipe: Recipe!
  status: Status!
  corruptionRemoved: BigInt!
  prismMinted: BigInt
  brokenTreasureIds: [BigInt!]!
  brokenTreasureAmounts: [BigInt!]!
}

"Tracks related Randomizer commits"
type Seeded @entity {
  id: Bytes!

  "Requests related to this commit"
  requests: [Removal!]!
}

type User @entity(immutable: true) {
  id: Bytes!

  removals: [Removal!]! @derivedFrom(field: "user")
}
